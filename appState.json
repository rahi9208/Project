{"EDITOR_STATE":{"allProjectFiles":{"932318f9-0f8b-475c-9d99-1cfe801292c4":{"id":"932318f9-0f8b-475c-9d99-1cfe801292c4","parent":null,"name":"TEST","type":"DIRECTORY","isDirectory":true,"children":["e32bc3f0-eb72-4400-bee8-d67305b3795c","aa72f105-8463-4fa8-a986-2762995d4013","6e35e014-b33a-4c20-bca7-a70456ab368e","8a28a891-83bc-468f-995a-d838c972e6f4","dcc7349c-7777-4f88-b3b4-3d1d3ab45e20"],"isRemovable":false,"filePath":"TEST"},"e32bc3f0-eb72-4400-bee8-d67305b3795c":{"id":"e32bc3f0-eb72-4400-bee8-d67305b3795c","parent":"932318f9-0f8b-475c-9d99-1cfe801292c4","name":"SaveProject.js","type":"LAMBDA_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"TEST/SaveProject.js","code":"let AWS = require('aws-sdk');\nconst ddb = new AWS.DynamoDB.DocumentClient();\nlet uuid = require('uuid');\nlet Auth = require('./Auth');\n\nexports.handler = function (event, context, callback) {\n\n    Auth.wrap(event, callback, (username) => {\n        let response = {\n            \"isBase64Encoded\": 1,\n            \"statusCode\": 200,\n            \"headers\": {\n                \"Access-Control-Allow-Origin\": \"*\"\n            },\n            \"body\": \"\"\n        };\n\n        let project = JSON.parse(event.body);\n\n        let createdTime = project.createdTime || new Date().getTime();\n        let updatedTime = new Date().getTime();\n        let projectId = project.projectId || (createdTime + \"-\" + uuid.v4());\n\n        ddb.put({\n            TableName: 'SigmaUserProjects',\n            Item: {\n                'name': project.name,\n                username,\n                projectId,\n                'description': project.description || \" \",\n                'functions': project.functions,\n                createdTime,\n                updatedTime,\n                region: project.region\n            }\n        }, function (err, data) {\n            if (err) {\n                console.error(\"Error in saving project of\", username, err);\n                response.statusCode = 500;\n                response.body = err.message;\n            } else {\n                console.log(\"Successfully saved project of %s with id %s\", username, projectId);\n                response.body = JSON.stringify({\n                    projectId\n                });\n            }\n            callback(null, response);\n        });\n    })\n}","triggers":[{"resourceName":"apigusEast1SigmaProjectspost","config":{}}],"config":{"memory":128,"timeout":60,"runtime":"nodejs8.10"},"testCases":{"f5db0cd0-1186-486d-ad0b-715eaaba2ff5":{"id":"f5db0cd0-1186-486d-ad0b-715eaaba2ff5","name":"Project1","functionId":"e32bc3f0-eb72-4400-bee8-d67305b3795c","event":"{\n    \"username\":\"cwidanage\",\n    \"name\": \"Project1\",\n    \"description\": \"Sample project description for a project created for serverless ide sigma\",\n    \"projectId\":\"4b7d40c0-8d0e-4f1a-80d7-d837717d8a95\",\n    \"functions\": [\"value3\"]\n}"},"d8616f9f-d75f-457b-91b4-95166085e1f3":{"id":"d8616f9f-d75f-457b-91b4-95166085e1f3","name":"Project2","functionId":"e32bc3f0-eb72-4400-bee8-d67305b3795c","event":"{\n    \"username\":\"cwidanage\",\n    \"name\": \"Project2\",\n    \"description\": \"Sample project description for a project created for serverless ide sigma\",\n    \"functions\": [\"value3\",\"a\",\"b\",\"d\"]\n}"}}},"aa72f105-8463-4fa8-a986-2762995d4013":{"id":"aa72f105-8463-4fa8-a986-2762995d4013","parent":"932318f9-0f8b-475c-9d99-1cfe801292c4","name":"GetProjects.js","type":"LAMBDA_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"TEST/GetProjects.js","code":"let AWS = require('aws-sdk');\nconst ddb = new AWS.DynamoDB.DocumentClient();\nlet Auth = require('./Auth');\n\nexports.handler = function (event, context, callback) {\n\n    Auth.wrap(event, callback, (username) => {\n\n        let response = {\n            \"statusCode\": 200,\n            \"headers\": {\n                \"Access-Control-Allow-Origin\": \"*\"\n            },\n            \"body\": \"...\"\n        };\n\n        let projectId = event.queryStringParameters && event.queryStringParameters.projectId;\n\n        if (!projectId) {\n            console.log(\"Searching all projects for\", username);\n\n            ddb.query({\n                TableName: 'SigmaUserProjects',\n                ExpressionAttributeValues: { ':username': username },\n                KeyConditionExpression: 'username = :username',\n            }, function (err, data) {\n                if (!err) {\n                    console.log(\"Successfully queried\", data.Items.length, \"for\", username);\n                    response.body = JSON.stringify(data.Items);\n                } else {\n                    response.statusCode = 500;\n                    console.error(\"Error occurred when searching for projects of\", username, err);\n                }\n                callback(err, response);\n            });\n        } else {\n            ddb.get({\n                TableName: 'SigmaUserProjects',\n                Key: { 'username': username, 'projectId': projectId }\n            }, function (err, data) {\n                if (!err) {\n                    console.log(\"Successfully queried project %s of %s\", projectId, username);\n                    response.body = JSON.stringify(data.Item);\n                } else {\n                    console.error(\"Error in fecthing %s of %s\", projectId, username);\n                    esponse.statusCode = 500;\n                }\n                callback(err, response);\n            });\n        }\n    });\n}","triggers":[{"resourceName":"apigusEast1SigmaProjectsget","config":{}}],"config":{"memory":128,"timeout":60,"runtime":"nodejs8.10"},"testCases":{"f3003788-e3eb-48f4-b74c-8698d3d69008":{"id":"f3003788-e3eb-48f4-b74c-8698d3d69008","name":"Unnamed event","functionId":"aa72f105-8463-4fa8-a986-2762995d4013","event":"{\n    \"queryStringParameters\": {\n        \"username\": \"cwidanage\"\n    },\n    \"headers\": {\n        \"Authorization\":\"eyJraWQiOiJha1N5eVRLK05HZlV0OFMzYnVzNlNJV3d0VDlxVitsbHFDMzh6YnowTElVPSIsImFsZyI6IlJTMjU2In0.eyJzdWIiOiJiNTBhNWIwNi03ZWU5LTQwOTQtOWM3My1mOTc0MTFhYmZmNjgiLCJldmVudF9pZCI6ImUwNGQzNGFiLTdmNGYtMTFlOC04MmE2LTViNjk3ZmFiNWI2NCIsInRva2VuX3VzZSI6ImFjY2VzcyIsInNjb3BlIjoiYXdzLmNvZ25pdG8uc2lnbmluLnVzZXIuYWRtaW4iLCJhdXRoX3RpbWUiOjE1MzA2ODQxNjcsImlzcyI6Imh0dHBzOlwvXC9jb2duaXRvLWlkcC51cy1lYXN0LTEuYW1hem9uYXdzLmNvbVwvdXMtZWFzdC0xX243Y0tON2wxdCIsImV4cCI6MTUzMDc3MjIzNSwiaWF0IjoxNTMwNzY4NjM1LCJqdGkiOiI3N2Y3YjliYi0yNmMxLTQxZjEtODlmZi1iNTU2NWVkMGFkYmIiLCJjbGllbnRfaWQiOiJqODQ4dWM0a3VqY2tjMmowdHRyMHRxajlvIiwidXNlcm5hbWUiOiJjd2lkYW5hZ2UifQ.i6EcwQDT7Ni30mejcuYa7Ke9XmmMaZ8XENia6ZzwCNr_7Vf4cyISxSBBmWE8YydroRVVlx5E2QtqKRkV2GTfmUSFsiH4Q-5Gr0LfCFW_igLGxZ9gWEGkVoRBE1E0TPUi-A7BlFi5PDbGctOFjbjhuEklE2QBrEEHGOnaito9YAHqz4fYLqOBbP9AQpattBuV9xqKku2jdHu3lFyqVKQFjyDbSyrDy7V6nPUIDex1kYQk56rpbX78JPIA8y9K4ergLSUB3oChm4Vom8AQGDkAK7soAq1s1w6AaovlHY1mE_i4xq97nIONNCmQgj1Adss0wtKeMkTrOzhQyII1C1WI3Q\"\n    }\n}"}},"customSecurityPolicy":{"Version":"2012-10-17","Statement":[]}},"6e35e014-b33a-4c20-bca7-a70456ab368e":{"id":"6e35e014-b33a-4c20-bca7-a70456ab368e","parent":"932318f9-0f8b-475c-9d99-1cfe801292c4","name":"RemoveProject.js","type":"LAMBDA_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"TEST/RemoveProject.js","code":"let AWS = require('aws-sdk');\nconst ddb = new AWS.DynamoDB.DocumentClient();\nlet Auth = require('./Auth');\n\nexports.handler = function (event, context, callback) {\n\n    Auth.wrap(event, callback, (username) => {\n        let response = {\n            \"isBase64Encoded\": 1,\n            \"statusCode\": 200,\n            \"headers\": {\n                \"Access-Control-Allow-Origin\": \"*\"\n            },\n            \"body\": \"...\"\n        }\n\n        let projectId = event.queryStringParameters.projectId;\n\n        ddb.delete({\n            TableName: 'SigmaUserProjects',\n            Key: { username, projectId }\n        }, function (err, data) {\n            if (!err) {\n                response.body = \"Successfully deleted \" + projectId;\n            } else {\n                response.statusCode = 500;\n            }\n            callback(err, response);\n        });\n    });\n}","triggers":[{"resourceName":"apigusEast1SigmaProjectsdelete","config":{}}],"config":{"memory":128,"timeout":60,"runtime":"nodejs8.10"},"testCases":{"6a44e1ec-bff4-415c-8da7-7482a8aa8ae3":{"id":"6a44e1ec-bff4-415c-8da7-7482a8aa8ae3","name":"Remove project","functionId":"6e35e014-b33a-4c20-bca7-a70456ab368e","event":"{\n    \"queryStringParameters\": {\n        \"username\":\"cwidanage\",\n        \"projectId\":\"1530613971577_2ba1e5c3-00f7-43fc-8ba4-5374a21e028f\"\n    }\n}"}}},"8a28a891-83bc-468f-995a-d838c972e6f4":{"id":"8a28a891-83bc-468f-995a-d838c972e6f4","parent":"932318f9-0f8b-475c-9d99-1cfe801292c4","name":"Auth.js","type":"JS_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"TEST/Auth.js","code":"const AWS = require('aws-sdk');\r\nconst cognitoidentityserviceprovider = new AWS.CognitoIdentityServiceProvider();\r\nexports.wrap = function (event, callback, logic) {\r\n    let response = {\r\n        \"statusCode\": 401,\r\n        \"headers\": {\r\n            \"Access-Control-Allow-Origin\": \"*\"\r\n        },\r\n        \"body\": \"\"\r\n    };\r\n\r\n    cognitoidentityserviceprovider.getUser({ AccessToken: (event.headers && event.headers.Authorization) || event.Authorization }, function (err, data) {\r\n        if (err) {\r\n            console.error(\"Error in authenticating user\", err);\r\n            response.body = JSON.stringify(err) || \"Authentication failure\";\r\n            callback(response, response);\r\n        } else {\r\n            logic(data.Username);\r\n        }\r\n    });\r\n}","triggers":[]},"dcc7349c-7777-4f88-b3b4-3d1d3ab45e20":{"id":"dcc7349c-7777-4f88-b3b4-3d1d3ab45e20","parent":"932318f9-0f8b-475c-9d99-1cfe801292c4","name":"widgets","type":"DIRECTORY","isDirectory":true,"children":["7e16374d-3701-49f0-8959-99ccd4cd99de","07ab749b-91bd-43b4-b1c3-2121e23f49b1"],"isRemovable":true,"filePath":"TEST/widgets"},"7e16374d-3701-49f0-8959-99ccd4cd99de":{"id":"7e16374d-3701-49f0-8959-99ccd4cd99de","parent":"dcc7349c-7777-4f88-b3b4-3d1d3ab45e20","name":"AddWidget.js","type":"LAMBDA_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"TEST/widgets/AddWidget.js","code":"let AWS = require('aws-sdk');\nconst ddb = new AWS.DynamoDB.DocumentClient();\nlet Auth = require('../Auth');\n\nexports.handler = function (event, context, callback) {\n    Auth.wrap(event, callback, (username) => {\n        let response = {\n            \"isBase64Encoded\": 1,\n            \"statusCode\": 200,\n            \"headers\": {\n                \"Access-Control-Allow-Origin\": \"*\"\n            },\n            \"body\": \"\"\n        };\n\n        let widget = JSON.parse(event.body);\n\n        let createdTime = widget.createdTime || new Date().getTime();\n        let updatedTime = new Date().getTime();\n        let widgetId = widget.widgetId || (createdTime + \"-\" + uuid.v4());\n\n        ddb.put({\n            TableName: 'DashboardWidgets',\n            Item: {\n                username,\n                widgetId,\n                widgetType:widget.type,\n                data:widget.data\n            }\n        }, function (err, data) {\n            if(!err){\n                console.log(\"Successfully saved widget of %s with id %s\", username, widgetId);\n                response.body = response.body = JSON.stringify({\n                    widgetId\n                });\n            }else{\n                console.error(\"Error in saving widget of\", username, err);\n                response.statusCode = 500;\n                response.body = err.message;\n            }\n            callback(null, response);\n        });\n    });\n    \n}","triggers":[{"resourceName":"apigusEast1SigmaProjectswidgetpost","config":{}}],"config":{"memory":128,"timeout":60,"runtime":"nodejs8.10"},"testCases":{"443dfb27-687a-4a68-9bb5-a2eec234f025":{"id":"443dfb27-687a-4a68-9bb5-a2eec234f025","name":"Unnamed event","functionId":"7e16374d-3701-49f0-8959-99ccd4cd99de","event":"{\n    \"body\": {\n        \"type\": \"YO\",\n        \"data\": {\n            \"hi\": \"Hello\",\n            \"bye\": 23\n        }\n    }\n}"}}},"07ab749b-91bd-43b4-b1c3-2121e23f49b1":{"id":"07ab749b-91bd-43b4-b1c3-2121e23f49b1","parent":"dcc7349c-7777-4f88-b3b4-3d1d3ab45e20","name":"RemoveWidget.js","type":"LAMBDA_FILE","isDirectory":false,"children":[],"isRemovable":true,"filePath":"TEST/widgets/RemoveWidget.js","code":"let AWS = require('aws-sdk');\nconst ddb = new AWS.DynamoDB.DocumentClient();\nlet Auth = require('../Auth');\n\nexports.handler = function(event, context, callback) {\n    Auth.wrap(event, callback, (username) => {\n        let response = {\n            \"isBase64Encoded\": 1,\n            \"statusCode\": 200,\n            \"headers\": {\n                \"Access-Control-Allow-Origin\": \"*\"\n            },\n            \"body\": \"...\"\n        }\n\n        let widgetId = event.queryStringParameters.widgetId;\n\n        ddb.delete({\n            TableName: 'DashboardWidgets',\n            Key: { username, widgetId }\n        }, function (err, data) {\n            if (!err) {\n                response.body = \"Successfully deleted \" + widgetId;\n            } else {\n                response.statusCode = 500;\n            }\n            callback(err, response);\n        });\n    });\n}","triggers":[{"resourceName":"apigusEast1SigmaProjectswidgetdelete","config":{}}],"config":{"memory":128,"timeout":60,"runtime":"nodejs8.10"}}},"rootNode":"932318f9-0f8b-475c-9d99-1cfe801292c4","openFiles":["e32bc3f0-eb72-4400-bee8-d67305b3795c","aa72f105-8463-4fa8-a986-2762995d4013","6e35e014-b33a-4c20-bca7-a70456ab368e","8a28a891-83bc-468f-995a-d838c972e6f4","7e16374d-3701-49f0-8959-99ccd4cd99de","07ab749b-91bd-43b4-b1c3-2121e23f49b1"],"currentFileId":"7e16374d-3701-49f0-8959-99ccd4cd99de","resources":{"ddbSigmaProjects":{"name":"ddbSigmaProjects","type":"DynamoDB","config":{"mode":0,"operation":"query","table":{"arn":"","name":"SigmaProjects","partitionKey":"id","partitionKeyType":"S","hasSortKey":true,"sortKey":"name","sortKeyType":"S","mode":0},"parameters":{"Key":{},"Item":{},"ExpressionAttributeValues":{":username":"@{username}"},"KeyConditionExpression":"id = :username","FilterExpression":""},"validator":{"validatableFields":{},"validity":true},"valid":true},"globallyEditable":false},"apigusEast1SigmaProjectsget":{"name":"apigusEast1SigmaProjectsget","type":"API_GATEWAY","config":{"selectedRegion":"us-east-1","apiMode":0,"apiName":"SigmaProjects","endpointType":"EDGE","resourceMode":0,"resourcePath":"/","resourceName":"","resourceId":"phbcku4s95","restMethod":"GET","proxyIntegration":true,"enableCORS":true,"stageMode":0,"stageName":"staging"},"globallyEditable":true},"ddbSigmaUserProjects":{"name":"ddbSigmaUserProjects","type":"DynamoDB","config":{"mode":0,"operation":"get","table":{"arn":"","name":"SigmaUserProjects","partitionKey":"username","partitionKeyType":"S","hasSortKey":true,"sortKey":"projectId","sortKeyType":"S","mode":0},"parameters":{"Key":{"username":"@{username}","projectId":"@{projectId}"},"Item":{},"ExpressionAttributeValues":{}},"validator":{"validatableFields":{},"validity":true},"valid":true},"globallyEditable":false},"apigusEast1SigmaProjectsdelete":{"name":"apigusEast1SigmaProjectsdelete","type":"API_GATEWAY","config":{"selectedRegion":"us-east-1","apiMode":0,"apiName":"SigmaProjects","endpointType":"EDGE","resourceMode":0,"resourceName":"","resourcePath":"/","restMethod":"DELETE","proxyIntegration":true,"enableCORS":true,"stageMode":0,"stageName":"staging"},"globallyEditable":true},"apigusEast1SigmaProjectspost":{"name":"apigusEast1SigmaProjectspost","type":"API_GATEWAY","config":{"selectedRegion":"us-east-1","apiMode":0,"apiName":"SigmaProjects","endpointType":"EDGE","resourceMode":0,"resourceName":"","resourcePath":"/","restMethod":"POST","proxyIntegration":true,"enableCORS":true,"stageMode":0,"stageName":"staging"},"globallyEditable":true},"apigusEast1SigmaProjectspinpost":{"name":"apigusEast1SigmaProjectspinpost","type":"API_GATEWAY","config":{"selectedRegion":"us-east-1","apiMode":0,"apiName":"SigmaProjects","apiId":"hwrjublxek","endpointType":"EDGE","rootResourceId":"a4opcpej9b","existingResources":{"/":"a4opcpej9b"},"resourceMode":0,"resourceName":"pin","resourcePath":"/pin","restMethod":"POST","proxyIntegration":true,"enableCORS":true,"stageMode":0,"stageName":"staging"},"globallyEditable":true},"apigusEast1SigmaProjectswidgetpost":{"name":"apigusEast1SigmaProjectswidgetpost","type":"API_GATEWAY","config":{"selectedRegion":"us-east-1","apiMode":0,"apiName":"SigmaProjects","endpointType":"EDGE","resourceMode":0,"resourceName":"widget","resourcePath":"/widget","restMethod":"POST","proxyIntegration":true,"enableCORS":true,"stageMode":0,"stageName":"staging"},"globallyEditable":true},"ddbDashboardWidgets":{"name":"ddbDashboardWidgets","type":"DynamoDB","config":{"mode":0,"operation":"put","table":{"arn":"","name":"DashboardWidgets","partitionKey":"username","partitionKeyType":"S","hasSortKey":true,"sortKey":"widgetId","sortKeyType":"S","mode":0},"parameters":{"Key":{},"Item":{},"ExpressionAttributeValues":{}},"validator":{"validatableFields":{},"validity":true},"valid":true},"globallyEditable":false},"apigusEast1SigmaProjectswidgetdelete":{"name":"apigusEast1SigmaProjectswidgetdelete","type":"API_GATEWAY","config":{"selectedRegion":"us-east-1","apiMode":0,"apiName":"SigmaProjects","apiId":"hwrjublxek","endpointType":"EDGE","rootResourceId":"a4opcpej9b","existingResources":{"/":"a4opcpej9b"},"resourceMode":0,"resourceName":"widget","resourcePath":"/widget","restMethod":"DELETE","proxyIntegration":true,"enableCORS":true,"stageMode":0,"stageName":"staging"},"globallyEditable":true}},"envVariables":[{"lambdaId":"all","varKey":"SIGMA_AWS_ACC_ID","varValue":null,"shouldPersist":false,"editable":false}],"packageJSON":{"dependencies":{"aws-sdk":{"name":"aws-sdk","version":"2.176.0","notRemovable":true}}},"lambdaId":"e32bc3f0-eb72-4400-bee8-d67305b3795c","additionalFiles":[],"deletedFiles":[]},"PROJECT_META":{"projectName":"TEST","projectDescription":"","projectVersion":"1.0.0","projectRegion":"us-east-1","repoName":"JK","repoUrl":"https://github.com/rahi9208/JK","lastSave":1529905665789},"VCS_STATE":{"provider":"GitHub","repo":{"name":"Project","url":"https://github.com/rahi9208/Project"}}}